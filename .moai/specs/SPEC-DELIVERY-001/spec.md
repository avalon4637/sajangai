---
id: SPEC-DELIVERY-001
version: "1.0.0"
status: draft
created: "2026-02-20"
priority: P2
depends_on:
  - SPEC-CONNECT-001
---

# SPEC-DELIVERY-001: 배달앱 매출 자동 연계

## 개요

배달의민족, 쿠팡이츠, 요기요 등 주요 배달 플랫폼의 매출/주문 데이터를 자동으로 조회하고 sajang.ai에 연계하는 시스템. 중개 API 플랫폼(하이픈 등)을 통해 배달앱 계정을 연결하고 매출/수수료/정산 정보를 자동 수집한다.

## 범위

- 배달앱 계정 연결 설정 (배민/쿠팡이츠/요기요)
- 매출/주문/정산 데이터 자동 조회
- 배달 수수료 자동 분리 (매출 vs 수수료 비용)
- revenues 및 expenses 테이블에 자동 저장
- 배달앱별 매출 비중 분석

## 범위 제외

- 배달앱 주문 관리 (주문 접수/처리)
- 배달앱 리뷰 관리
- 배달 대행 연동

---

## Requirements (EARS)

### REQ-01: 배달앱 계정 연결

**Ubiquitous:**
- 시스템은 다음 배달 플랫폼 계정 연결을 지원해야 한다:
  - 배달의민족 (배민1 포함)
  - 쿠팡이츠
  - 요기요

**Event-Driven:**
- WHEN 사용자가 배달앱 계정 정보를 입력하면 THEN 시스템은 연결 상태를 검증해야 한다.

### REQ-02: 매출 데이터 조회

**Event-Driven:**
- WHEN 동기화가 실행되면 THEN 시스템은 각 배달앱의 매출/주문 데이터를 조회해야 한다.

**Ubiquitous:**
- 시스템은 다음 데이터를 조회해야 한다:
  - 주문 금액 (매출)
  - 배달 수수료 (비용)
  - 정산 금액 (실입금)
  - 주문 일시/채널

### REQ-03: 데이터 분류 및 저장

**Ubiquitous:**
- 시스템은 배달앱 매출을 revenues 테이블에 자동 저장해야 한다.
  - channel: "배민" | "쿠팡이츠" | "요기요"
  - category: "배달" | "포장"
- 시스템은 배달 수수료를 expenses 테이블에 자동 저장해야 한다.
  - type: "variable"
  - category: "배달수수료"

### REQ-04: 배달앱 분석 위젯

**Ubiquitous:**
- 시스템은 대시보드에 배달앱별 매출 비중, 수수료율, 순매출을 표시하는 위젯을 제공해야 한다.

---

## 기술 조사 결과

### 배달앱 데이터 연동 방식

- 하이픈(HYPHEN) API: 배달앱 매출정보 조회 API, 100+ 배달 대행업체 연동
- 배달 플랫폼 표준 API: 개인정보보호위원회 주도로 표준 API 서식 마련 (2023)
- 캐시노트 방식: 배달앱 ID/PW 입력 → 스크래핑 기반 데이터 수집

### 데이터 구조 (하이픈 기준)

- 매출 조회: 일별/월별 매출 합계, 주문 건수
- 정산 조회: 정산 예정액, 정산 완료액, 수수료 내역
- 주문 조회: 개별 주문 상세 (주문번호, 메뉴, 금액)

### 선행 과제

1. 중개 API 플랫폼 계약 (SPEC-CONNECT-001과 동일 플랫폼 권장)
2. 배달앱별 인증 방식 확인
3. 수수료 구조 분석 (플랫폼별 상이)

<!-- TAG: SPEC-DELIVERY-001 -->
